{"version":3,"sources":["../src/edu.js"],"names":["define","$","init","a","b","c","window","pageYOffset","document","documentElement","body","parentNode","scrollTop","d","clientHeight","f","getBoundingClientRect","height","g","top","h","bottom","expr","e","parseInt","ajaxSetup","cache","videoFormat","v","createElement","canPlayType","replace","renderEsObject","esObject","wrapper","url","attr","parent","get","data","html","append","css","display","width","fadeIn","toLowerCase","indexOf","setTimeout","removeAttr","each","scroll","click","target","closest","length","fadeOut","toggle_button","metadata","find","hasClass","toggleClass","removeClass"],"mappings":"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","sourcesContent":["// This file is part of edu-sharing created by metaVentis GmbH — http://metaventis.com\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @package    filter_edusharing\n * @copyright  metaVentis GmbH — http://metaventis.com\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n\ndefine(['jquery'], function($) {\n\n    return {\n        init: function() {\n\n            !(function() {\n                function a(a, b) {\n                    var c = void 0 !== window.pageYOffset ? window.pageYOffset : (document.documentElement ||\n                            document.body.parentNode || document.body).scrollTop,\n                        d = document.documentElement.clientHeight,\n                        e = c + d;\n                    b = b || 0;\n                    var f = a.getBoundingClientRect();\n                    if (0 === f.height) {\n                     return !1;\n                    }\n                    var g = f.top + c - b,\n                        h = f.bottom + c + b;\n                    return h > c && e > g;\n                }\n\n                $.expr[\":\"][\"near-viewport\"] = function(b, c, d) {\n                    var e = parseInt(d[3]) || 0;\n                    return a(b, e);\n                };\n            }());\n\n            $.ajaxSetup({cache: false});\n\n            var videoFormat = 'webm';\n            var v = document.createElement('video');\n            if (v.canPlayType && v.canPlayType('video/mp4').replace(/no/, '')) {\n                videoFormat = 'mp4';\n            }\n\n            function renderEsObject(esObject, wrapper) {\n                var url = esObject.attr(\"data-url\") + '&videoFormat=' + videoFormat;\n                if (typeof wrapper == 'undefined') {\n                    var wrapper = esObject.parent();\n                }\n                $.get(url, function(data) {\n                    wrapper.html('').append(data).css({display: 'none', height: 'auto', width: 'auto'}).fadeIn('slow', 'linear');\n                    if (data.toLowerCase().indexOf('data-view=\"lock\"') >= 0) {\n                        setTimeout(function() {\n                            renderEsObject(esObject, wrapper);\n                        }, 1111);\n                    }\n                });\n                esObject.removeAttr(\"data-type\");\n            }\n\n            $(\"div[data-type='esObject']:near-viewport(400)\").each(function() {\n                renderEsObject($(this));\n            });\n\n            $(window).scroll(function() {\n                $(\"div[data-type='esObject']:near-viewport(400)\").each(function() {\n                    renderEsObject($(this));\n                });\n            });\n\n            $(\"body\").click(function(e) {\n                if ($(e.target).closest(\".edusharing_metadata\").length) {\n                    // Clicked inside \".edusharing_metadata\" - do nothing\n                } else if ($(e.target).closest(\".edusharing_metadata_toggle_button\").length) {\n                    $(\".edusharing_metadata\").fadeOut('fast');\n                    let toggle_button = $(e.target);\n                    let metadata = toggle_button.parent().find(\".edusharing_metadata\");\n                    if (metadata.hasClass('open')) {\n                        metadata.toggleClass('open');\n                        metadata.fadeOut('fast');\n                    } else {\n                        $(\".edusharing_metadata\").removeClass('open');\n                        metadata.toggleClass('open');\n                        metadata.fadeIn('fast');\n                    }\n                } else {\n                    $(\".edusharing_metadata\").fadeOut('fast');\n                    $(\".edusharing_metadata\").removeClass('open');\n                }\n            });\n        }\n    };\n});\n"],"file":"edu.min.js"}